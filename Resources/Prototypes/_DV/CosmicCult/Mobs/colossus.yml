- type: entity
  parent: [ BaseMob, FlyingMobBase ]
  abstract: true
  id: MobCosmicColossusBase
  name: entropic colossus
  description: A colossal monstrosity of malign plating and dendritic infestation.
  components:
  - type: FTLSmashImmune
  - type: CosmicCultExamine
    cultistText: cosmic-examine-text-cultentity
    othersText: cosmic-examine-text-entities
  - type: AntagImmune
  - type: Sprite
    drawdepth: Mobs
    sprite: _DV/CosmicCult/Mobs/colossus.rsi
    layers:
    - state: unshaded_bg
      shader: unshaded
      map: ["underlay"]
    - state: colossus
      map: ["base"]
    - state: dead
      visible: false
      map: ["corpse"]
    - state: unshaded_fg
      shader: unshaded
      map: ["overlay"]
    - state: attacking
      shader: unshaded
      visible: false
      map: ["attack"]
    - state: hibernate
      shader: unshaded
      visible: false
      map: ["hibernating"]
  - type: Appearance
  - type: GenericVisualizer
    visuals:
      enum.ColossusVisuals.Status:
        underlay:
          Alive: { visible: true }
          Dead: { visible: false }
          Action: { visible: false }
        base:
          Alive: { visible: true }
          Dead: { visible: false }
          Action: { visible: false }
        corpse:
          Alive: { visible: false }
          Dead: { visible: true }
          Action: { visible: false }
        overlay:
          Alive: { visible: true }
          Dead: { visible: false }
          Action: { visible: false }
        attack:
          Alive: { visible: false }
          Dead: { visible: false }
          Action: { visible: true }
      enum.ColossusVisuals.Hibernation:
        hibernating:
          Running: { visible: true }
          Stopped: { visible: false }
      enum.ColossusVisuals.Sunder:
        sunder:
          Running: { visible: true }
          Stopped: { visible: false }
  - type: Physics
    bodyType: KinematicController
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.40
        density: 2500
        mask:
        - FlyingMobMask
        layer:
        - FlyingMobLayer
  - type: Emoting
  - type: Speech
    speechSounds: ColossusSpeech
    speechVerb: Robotic
    allowedEmotes: []
  - type: LanguageKnowledge # TODO: coscult language
    speaks:
    - TauCetiBasic
    - RobotTalk # It still has a borg inside
    understands:
    - TauCetiBasic
    - RobotTalk
  - type: TypingIndicator
    proto: CosmicTyping
  - type: Grammar
    attributes:
      proper: true
      gender: epicene
  - type: ProtectedFromStepTriggers
  - type: MovementSpeedModifier
    baseWalkSpeed: 2
    baseSprintSpeed: 3
    baseWeightlessModifier: 1
    weightlessAcceleration: 1.5
    weightlessFriction: 1
  - type: AmbientSound
    volume: +8
    range: 18
    sound:
      path: /Audio/_DV/CosmicCult/colossus_ambience.ogg
  - type: EmitSoundOnSpawn
    sound:
      path: /Audio/_DV/CosmicCult/colossus_spawn.ogg
  - type: Tag
    tags:
    - CannotSuicide
    - DoorBumpOpener
    - Unimplantable
    - StunImmune
  - type: Damageable
    damageContainer: InorganicMetaphysical
    damageModifierSet: CosmicColossus
  - type: MobThresholds
    thresholds:
      0: Alive
      400: Dead
  - type: MobState
    allowedStates:
    - Alive
    - Dead
  - type: PassiveDamage
    allowedStates:
    - Alive
    damage:
      groups: # This is split across damage types, so it's only about 30 damage per minute per type, which means more than 10 minutes to reach full HP (assuming one damage type)
        Brute: -1.5
        Burn: -2
  - type: Eye
    visMask:
      - Normal
      - CosmicCultMonument
  - type: StatusEffects
    allowed:
    - ForcedSleep
  - type: IntrinsicRadioReceiver
  - type: IntrinsicRadioTransmitter
    channels:
    - Common
    - CosmicRadio
  - type: ActiveRadio
    channels:
    - Common
    - CosmicRadio
  - type: ZombieImmune
  - type: UserInterface
    interfaces:
      enum.SiliconLawsUiKey.Key:
        type: SiliconLawBoundUserInterface
        requireInputValidation: false
  - type: SiliconLawBound
  - type: SiliconLawProvider
    laws: CosmicCultLaws
  - type: NoSlip
  - type: Puller
    needsHands: false
  - type: CombatMode
  - type: ActionGrant
    actions:
    - ActionViewLaws
    - ActionCosmicColossusSunder
    - ActionCosmicColossusIngress
    - ActionCosmicColossusHibernate
  - type: MeleeWeapon
    altDisarm: false
    animation: WeaponArcCosmic
    attackRate: 0.5
    range: 2
    damage:
      types:
        Blunt: 50
        Cold: 2.5
        Ion: 2.5
        Structural: 80
    soundHit:
      path: /Audio/_DV/CosmicCult/cosmicsword_glance.ogg
      params:
        variation: 0.2
        volume: 1
    soundSwing:
      path: /Audio/_DV/CosmicCult/cosmicweapon_swing.ogg
      params:
        variation: 0.125
        volume: -4
  - type: MeleeThrowOnHit
    speed: 8
    distance: 5
  - type: GhostRole
    name: ghost-role-information-colossus-name
    description: ghost-role-information-colossus-description
    rules: ghost-role-information-colossus-rules
    mindRoles:
    - MindRoleCosmicColossus
    raffle:
      settings: default
  - type: GhostTakeoverAvailable
  - type: GuideHelp
    guides:
    - CosmicColossus
  - type: NightVision
    color: "#42a4ae"
    activateSound: null
    deactivateSound: null
  - type: Polymorphable
  - type: Pullable
  - type: AlwaysTakeHoly
  - type: CosmicColossus
    sunderBlacklist:
      components:
      - Ghost
      - CosmicCult
      - CosmicColossus

- type: entity
  parent: [ MobCosmicColossusBase ]
  categories: [ HideSpawnMenu ]
  id: MobCosmicColossusLone
  suffix: MidRoundAntag
  description: An ancient monstrosity of malign plating and dendritic infestation.
  components:
  - type: RandomMetadata
    nameSegments:
    - ColossusNames
    - ColossusTitlesLone
    nameFormat: name-format-colossus
  - type: CosmicColossus
    timed: true

- type: entity
  parent: [ MobCosmicColossusBase ]
  id: MobCosmicColossus
  components:
  - type: RandomMetadata
    nameSegments:
    - ColossusNames
    - ColossusTitlesBase
    nameFormat: name-format-colossus

- type: speechSounds
  id: ColossusSpeech
  saySound:
    path: /Audio/_DV/CosmicCult/colossus_say.ogg
  askSound:
    path: /Audio/_DV/CosmicCult/colossus_ask.ogg
  exclaimSound:
    path: /Audio/_DV/CosmicCult/colossus_exclaim.ogg

- type: entity
  categories: [ HideSpawnMenu ]
  id: MobTileDamageZone
  placement:
    mode: SnapgridCenter
    snap:
    - Wall
  components:
  - type: Transform
    anchored: true
  - type: EmitSoundOnSpawn
    sound:
      path: /Audio/_DV/CosmicCult/tile_detonate.ogg
  - type: TimedDespawn
    lifetime: 8

- type: entity
  categories: [ HideSpawnMenu ]
  id: MobTileDamageArea
  placement:
    mode: SnapgridCenter
    snap:
    - Wall
  components:
  - type: TimedDespawn
    lifetime: 0.6
  - type: Transform
    anchored: true
  - type: Sprite
    snapCardinals: true
    sprite: _DV/CosmicCult/Effects/tile_attacks.rsi
    offset: 0,0.27
    layers:
    - state: tiledamage_start
      shader: unshaded
  - type: Tag
    tags:
    - HideContextMenu
  - type: SpawnOnDespawn
    prototype: MobTileDamageIssuer

- type: entity
  categories: [ HideSpawnMenu ]
  id: MobTileDamageIssuer
  placement:
    mode: SnapgridCenter
    snap:
    - Wall
  components:
  - type: Sprite
    snapCardinals: true
    sprite: _DV/CosmicCult/Effects/tile_attacks.rsi
    offset: 0,0.27
    layers:
    - state: tiledamage_end
      shader: unshaded
  - type: Transform
    noRot: true
    anchored: true
  - type: TimedDespawn
    lifetime: 1
  - type: Physics
    bodyType: Static
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeAabb
          bounds: "-0.5,-0.5,0.5,0.5"
        layer:
          - SlipLayer
        mask:
          - ItemMask
        density: 2500
        hard: false
  - type: StepTrigger
    requiredTriggeredSpeed: 0
    intersectRatio: 0.1
    ignoreWeightless: true
    blacklist:
      tags:
        - Catwalk
  - type: TileEntityEffect
    effects:
    - !type:HealthChange
      damage:
        types:
          Cold: 12.5
